# Yakeru-USB 開発ガイド

このガイドでは、Yakeru-USBアプリケーションの開発方法について説明します。

## WriterSampleシーンの作成方法

### 1. 基本的なシーンのセットアップ

1. Unityエディタを開き、プロジェクトブラウザで `Assets` フォルダを右クリックします
2. `Create` > `Folder` を選択し、`Scenes` というフォルダを作成します
3. 新しく作成した `Scenes` フォルダを右クリックし、`Create` > `Scene` を選択します
4. 新しいシーンに `WriterSample` という名前を付けます
5. 作成したシーンをダブルクリックして開きます

### 2. UIキャンバスの設定

1. シーンに階層ビューで右クリックし、`UI` > `Canvas` を選択します
2. キャンバスを選択した状態で、インスペクタパネルで以下のように設定します：
   - Canvas Scaler (Script)コンポーネントの `UI Scale Mode` を `Scale With Screen Size` に設定
   - `Reference Resolution` を `1920 x 1080` に設定

3. 階層ビューでCanvasを右クリックし、`UI` > `Event System` を追加します

### 3. 基本的なUI要素の追加

#### 3.1 パネルレイアウトの作成

1. Canvasを右クリックし、`UI` > `Panel` を選択し、メインパネルを作成します
2. パネルを選択し、Anchor Presets（インスペクタの左上にある四角いボタン）を押しながらAltキーを押し、「Stretch-Stretch」を選択して画面全体に広がるようにします
3. パネルの色を変更するには、Imageコンポーネントの `Color` プロパティを調整します（例：#1E1E1E）

4. このメインパネルを右クリックし、以下のパネルを作成します：
   - `LeftPanel` (ISOファイルリスト用)
   - `RightPanel` (USBデバイスリスト用)
   - `BottomPanel` (操作ボタンと進捗表示用)

5. 各パネルのRect Transformを適切に設定し、画面レイアウトを構成します

#### 3.2 リストビューの作成

1. `LeftPanel` を右クリックし、`UI` > `Scroll View` を選択します
2. スクロールビューの名前を `ISOListScrollView` に変更します
3. 同様に、`RightPanel` にも `USBListScrollView` というスクロールビューを作成します

4. 各スクロールビューの Content オブジェクトをリストアイテムのコンテナとして使用します

#### 3.3 リストアイテムのプレハブ作成

1. プロジェクトビューで `Assets` フォルダを右クリックし、`Create` > `Folder` で `Prefabs` フォルダを作成します
2. 階層ビューで一時的に `UI` > `Button` を作成し、名前を `ISOListItem` に変更します
3. このボタンをカスタマイズします：
   - サイズを調整（例：幅 400, 高さ 60）
   - ボタンにテキスト要素を2つ持たせるため、子オブジェクトとして新しいTextオブジェクトを追加します
   - 元のTextを `NameText` に、新しいTextを `SizeText` に変更します
   - テキストの配置やフォントサイズを調整します

4. 完成したボタンをプロジェクトビューの `Prefabs` フォルダにドラッグして、プレハブとして保存します
5. 同様の手順で `USBListItem` プレハブも作成します

### 4. スクリプトとコンポーネントの接続

1. 空のゲームオブジェクトを3つ作成し、以下の名前を付けます：
   - `APIClient`
   - `WebSocketClient`
   - `ISOManager`

2. それぞれのゲームオブジェクトに、対応する名前のスクリプトをアタッチします

3. キャンバス下に空のゲームオブジェクトを作成し、`UIController` という名前を付け、同名のスクリプトをアタッチします

4. `UIController` コンポーネントのインスペクタで、以下のプロパティを設定します：
   - `ISO List Content`: ISOListScrollView の Content オブジェクトをドラッグ
   - `ISO List Item Prefab`: 作成した ISOListItem プレハブをドラッグ
   - `USB List Content`: USBListScrollView の Content オブジェクトをドラッグ
   - `USB List Item Prefab`: 作成した USBListItem プレハブをドラッグ
   - その他の参照（ボタン、パネル、テキスト要素など）も同様に設定

### 5. 進捗表示UIの作成

1. `BottomPanel` に子オブジェクトとして新しい `Panel` を作成し、`ProgressPanel` という名前を付けます
2. この中に `UI` > `Slider` を追加し、進捗バーとして使用します
3. スライダーの見た目をカスタマイズし、シーン上で目立つようにします
4. `UI` > `Text - TextMeshPro` を2つ追加し、それぞれ `ProgressText` と `StatusText` という名前を付けます
5. `UIController` スクリプトの対応するプロパティにこれらの要素を接続します

### 6. メッセージパネルの追加

1. キャンバスに子オブジェクトとして新しい `Panel` を作成し、`MessagePanel` という名前を付けます
2. このパネルには以下の要素を追加します：
   - 背景パネル（半透明の黒など）
   - メッセージ用テキスト（TextMeshPro）
   - 「閉じる」ボタン
3. `UIController` スクリプトの対応するプロパティにこれらの要素も接続します

### 7. シーンの保存と実行

1. すべての設定が完了したら、シーンを保存します
2. シーンをビルド設定に追加するには、`File` > `Build Settings` を開き、`Add Open Scenes` をクリックします
3. プレイモードで動作確認を行います

## UIデザインのヒント

### 全体的なレイアウト

```
+---------------------------------------+
|              Header                   |
+---------------+---------------------+ |
| ISO Files     | USB Devices         | |
| +-----------+ | +-----------------+ | |
| | ubuntu.iso| | | Kingston USB    | | |
| +-----------+ | +-----------------+ | |
| | debian.iso| | | SanDisk Ultra   | | |
| +-----------+ | +-----------------+ | |
|               |                     | |
+---------------+---------------------+ |
| Selected:     | Selected:           | |
| ubuntu.iso    | Kingston USB (32GB) | |
+---------------+---------------------+ |
|  [Refresh]    [Write to USB]  [Quit] |
|                                      |
|  [========Progress Bar========] 45%  |
|  Writing data...                     |
+--------------------------------------+
```

### 配色の提案

- 背景色: #1E1E1E (濃いグレー)
- パネル背景: #2D2D30 (少し明るいグレー)
- ボタン: #007ACC (青)
- テキスト: #FFFFFF (白)
- 進捗バー: #388E3C (緑)
- エラーテキスト: #E57373 (赤)

## エラー処理とユーザーフィードバック

- アクションが失敗した場合は、明確なエラーメッセージでユーザーに通知
- 書き込み中は進捗バーとステータステキストで現在の状態を示す
- 書き込み完了時は、成功メッセージと共に結果を表示

## ビルドとデプロイ

1. `File` > `Build Settings` を開く
2. 対象プラットフォームを選択（Windows/macOS/Linux）
3. `Build` または `Build And Run` をクリック
4. 出力先フォルダを選択して、アプリケーションをビルド
5. ビルドしたアプリケーションはバックエンドAPIサーバーと同じマシン上で実行するのがベスト
